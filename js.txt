 javascript:(async function(){const scanningDiv=document.createElement("div");Object.assign(scanningDiv.style,{position:"fixed",bottom:"0",left:"0",width:"100%",maxHeight:"50%",overflowY:"scroll",backgroundColor:"#f8f9fa",color:"#212529",padding:"10px",zIndex:"9999",borderTop:"2px solid #000",boxShadow:"0 -2px 5px rgba(0,0,0,0.1)",fontFamily:"Arial, sans-serif",fontSize:"14px"}),scanningDiv.innerHTML="<h4>Scanning...</h4>",document.body.appendChild(scanningDiv);const uniquePaths=new Set;async function fetchContent(url){try{const response=await fetch(url);return response.ok?await response.text():(console.error(`Failed to fetch ${url}: ${response.status}`),null)}catch(error){return console.error(`Error fetching ${url}:`,error),null}}function isValidRelativePath(path){return(path.startsWith("/")||path.startsWith("./")||path.startsWith("../"))&&!path.includes(" ")&&/^[\x20-\x7E]+$/.test(path)&&path.length>1&&path.length<200}function extractPaths(content){return[...content.matchAll(/['"]((?:\/|\.\.\/|\.\/)[^'"]+)['"]/g)].map(match=>match[1]).filter(isValidRelativePath)}function extractJsonEndpoints(content){try{const json=JSON.parse(content),endpoints=[];function traverse(obj){"string"==typeof obj&&isValidRelativePath(obj)?endpoints.push(obj):"object"==typeof obj&&null!==obj&&Object.values(obj).forEach(traverse)}return traverse(json),endpoints}catch{return[]}}function extractScriptEndpoints(){return Array.from(document.querySelectorAll("script[src]")).map(script=>script.src).filter(isValidRelativePath)}function extractLinkEndpoints(){return Array.from(document.querySelectorAll("link[href]")).map(link=>link.href).filter(isValidRelativePath)}function extractInlineEventEndpoints(){return Array.from(document.querySelectorAll("*[onclick], *[onmouseover], *[onmouseout]")).flatMap(el=>["onclick","onmouseover","onmouseout"].map(attr=>el.getAttribute(attr)).filter(Boolean)).flatMap(handler=>extractPaths(handler))}function extractJsonAttributes(){return Array.from(document.querySelectorAll("[data-json]")).flatMap(el=>extractJsonEndpoints(el.getAttribute("data-json")))}function extractFormActions(){return Array.from(document.querySelectorAll("form[action]")).map(form=>form.action).filter(isValidRelativePath)}function extractIframeEndpoints(){return Array.from(document.querySelectorAll("iframe[src]")).map(iframe=>iframe.src).filter(isValidRelativePath)}function extractImageSources(){return Array.from(document.querySelectorAll("img[src]")).map(img=>img.src).filter(isValidRelativePath)}function extractObjectEmbedEndpoints(){return Array.from(document.querySelectorAll("object[data], embed[src]")).map(obj=>obj.data||obj.src).filter(isValidRelativePath)}async function processURL(url){if(!uniquePaths.has(url)){uniquePaths.add(url),console.log(`Processing: ${url}`);const content=await fetchContent(url);if(content){const paths=extractPaths(content),jsonEndpoints=extractJsonEndpoints(content);paths.concat(jsonEndpoints).forEach(path=>uniquePaths.add(path))}}}const resources=performance.getEntriesByType("resource").map(entry=>entry.name);console.log("Resources found:",resources);for(const resource of resources)await processURL(resource);[...extractScriptEndpoints(),...extractLinkEndpoints(),...extractInlineEventEndpoints(),...extractJsonAttributes(),...extractFormActions(),...extractIframeEndpoints(),...extractImageSources(),...extractObjectEmbedEndpoints()].forEach(endpoint=>uniquePaths.add(endpoint));const results=Array.from(uniquePaths);console.log("Final list of unique paths:",results),scanningDiv.innerHTML=`<h4>Unique Paths Found (${results.length}):</h4><ul>${results.map(path=>`<li>${path}</li>`).join("")}</ul>`})();
